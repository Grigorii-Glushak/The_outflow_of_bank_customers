# Отток клиентов банка
***Описание проекта:*** 

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 

Постройте модель с предельно большим значением *F1*-меры (не менее 0.59).

Дополнительно измерьте *AUC-ROC*, сравните её значение с *F1*-мерой.

***План работы над проектом:***

1. Подготовка данных;
2. Исследование задачи;
3. Борьба с дисбалансом;
4. Тестирование модели;
5. Общий вывод.

## Вывод
В начале исследования мы подготовили данные для обучения модели:
- удалили пропуски в столбце `Tenure` (сколько лет человек является клиентом банка) - `909 штук` (олоко `9%` от всех данных) так как нет возможности их восстановить
- мы переимменовали все названия столцов для удобства дальнейшего использования
- и удалили часть столбцов, которые не нужны для обучения модели, а именно `row_number, surname, customer_id`
- закодировали категориальные признаки как однократный числовой массив. Использовали метод OneHotEncoder
- разбили датасет на `3` части. На обучающую выборку - это будет `60%` данных. На валидную и тестовую мы отвели по `20% (3|1|1)`
- стандартизаровали данные при помощи `StandardScaler`.

При поиске оптимальной модели мы обнаружили:
Что существует заментый дисбаланс. Положительных значений значительно меньше. Лучшие показатели F1 у моделей `RandomForestClassifier`, где `F1=0.57` и `DecisionTreeClassifier` с таким же показателем, но значение `recall` у `DecisionTreeClassifier` больше. `0.47 к 0.44`, а вот с `AUC-ROC` моделей наоборот. У `RandomForestClassifier` больше. `0.85 к 0.83`.

Мы сбалансировали модель `2` разными способами. Лучший результат показал вариант с уменьшением отрицательных целевых значений (`downsample`). А модель `RandomForestClassifier` со значением `F1=0.64 и AUC-ROC= 0.86` получилась лучше остальных. Показатель recall у неё `0.59`. На тестовой выборке она сохранила показатели метрики. Что касается адекватности, то `AUC-ROC` константой модели - `0.5`, а у нашей лучшей модели `AUC-ROC - 0.87`. Адекватность доказана.
